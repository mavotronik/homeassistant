title: Система
icon: mdi:home-assistant
cards:

    - type: vertical-stack
      cards:
      
        - type: markdown
          style: |
              ha-card {
                font-size: 30px;
              }          
          content: >
             **Система**
        - type: custom:stack-in-card
          mode: vertical
          cards:

            - type: entities
              show_header_toggle: false
              entities:
                
              - entity: sensor.last_boot_custom
                type: custom:multiple-entity-row
                name: Uptime
                state_header: Сервер
                entities:
                  - entity: sensor.online_custom
                    name: Home Assistant
                    
              # - entity: binary_sensor.rpi_power_status
                # type: custom:multiple-entity-row
                # name: Питание
                # state_header: Статус
                # entities:
                  # - entity: sensor.212a01_5448e6d89786_power
                    # name: Потр. мощность
                    
              - entity: sensor.processor_use
                type: custom:multiple-entity-row
                name: Процессор
                state_header: Загрузка
                entities:
                  - entity: sensor.processor_temperature
                    name: Температура
                    
              - entity: sensor.memory_use
                type: custom:multiple-entity-row
                name: Память
                state_header: Использовано
                entities:
                  - entity: sensor.memory_free
                    name: Свободно
                  - entity: sensor.memory_use_percent
                    name: Исп %
                    
              - entity: sensor.disk_use
                type: custom:multiple-entity-row
                name: Диск
                state_header: Использовано
                entities:
                  - entity: sensor.disk_free_home
                    name: Свободно
                  - entity: sensor.disk_use_percent
                    name: Исп %
                  - entity: counter.days_of_memory_life
                    name: Дней
                    
              - entity: sensor.swap_use
                type: custom:multiple-entity-row
                name: Swap
                state_header: Использовано
                entities:
                  - entity: sensor.swap_free
                    name: Свободно
                    
        - type: grid
          columns: 3
          square: false
          cards:
          
            - type: button 
              name: Розетка перезагрузка
              entity: input_button.server_plug_reload
              tap_action:
                action: toggle

            - type: button
              name: Бэкап
              entity: input_button.manual_backup
              tap_action:
                action: toggle              
                  
            - type: button
              name: Сжатие базы
              entity: input_button.manual_db_purge
              tap_action:
                action: toggle  
                  
    - type: vertical-stack
      cards:
      
        - type: markdown
          style: |
              ha-card {
                font-size: 26px;
              }          
          content: >
             **Графики**
             
        - type: grid
          columns: 2
          square: false
          cards:
             
            - type: custom:mini-graph-card
              entities:
                - entity: sensor.processor_use
                  name: Процессор
              color_thresholds:
                - value: 20
                  color: "#7FFF00"
                - value: 40
                  color: "#98FB98"
                - value: 60
                  color: "#FFFF00"
                - value: 80
                  color: "#FF8C00"
                - value: 100
                  color: "#DC143C"
              animate: true
              line_width: 2
              hour24: true
              points_per_hour: 5
              group_by: hour
              hours_to_show: 168
          
            - type: custom:mini-graph-card
              entities:
                - entity: sensor.processor_temperature
                  name: Температура
              color_thresholds:
                - value: 20
                  color: "#7FFF00"
                - value: 40
                  color: "#98FB98"
                - value: 60
                  color: "#FFFF00"
                - value: 80
                  color: "#DC143C"   ##FF8C00
                - value: 100
                  color: "#DC143C"
              animate: true
              line_width: 2
              hour24: true
              points_per_hour: 5
              group_by: hour
              hours_to_show: 168
              
            - type: custom:mini-graph-card
              entities:
                - entity: sensor.memory_use_percent
                  name: Память
              color_thresholds:
                - value: 20
                  color: "#7FFF00"
                - value: 40
                  color: "#98FB98"
                - value: 60
                  color: "#FFFF00"
                - value: 80
                  color: "#FF8C00"
                - value: 100
                  color: "#DC143C"
              animate: true
              line_width: 2
              hour24: true
              points_per_hour: 5
              group_by: hour
              hours_to_show: 168
              
            - type: custom:mini-graph-card
              entities:
                - entity: sensor.disk_use_percent
                  name: Диск
              color_thresholds:
                - value: 20
                  color: "#7FFF00"
                - value: 40
                  color: "#98FB98"
                - value: 60
                  color: "#FFFF00"
                - value: 80
                  color: "#FF8C00"
                - value: 100
                  color: "#DC143C"
              animate: true
              line_width: 2
              hour24: true
              points_per_hour: 5
              group_by: hour
              hours_to_show: 168
              
            - type: custom:mini-graph-card
              entities:
                - entity: sensor.maria_db_size    
                  name: Объем базы Maria DB
              color_thresholds:
                - value: 500
                  color: "#7FFF00"
                - value: 750
                  color: "#98FB98"
                - value: 1000
                  color: "#FFFF00"
                - value: 1250
                  color: "#FF8C00"
                - value: 1500
                  color: "#DC143C"
              animate: true
              line_width: 2
              hour24: true
              points_per_hour: 5
              group_by: hour
              hours_to_show: 672
              
#            - type: custom:mini-graph-card
#              entities:
#                - entity: sensor.battery_charge  
#                  name: Заряд аккумулятора
#              color_thresholds:
#                - value: 100
#                  color: "#7FFF00"
#                - value: 80
#                  color: "#98FB98"
 #               - value: 50
#                  color: "#FFFF00"
#                - value: 35
#                  color: "#FF8C00"
#                - value: 15
#                  color: "#DC143C"
#              animate: true
#              line_width: 2
#              hour24: true
#              points_per_hour: 5
#              group_by: hour
#              hours_to_show: 168
              
    - type: vertical-stack
      cards:
      
        - type: markdown
          style: |
              ha-card {
                font-size: 26px;
              }          
          content: >
             **Обновления**
        
        - type: entities
          entities:
            - entity: update.home_assistant_core_update
              secondary_info: last-changed
              name: Обновления Home Assistant
            - entity: update.home_assistant_supervisor_update
              secondary_info: last-changed
              name: Обновления Supervisor
 #           - entity: update.home_assistant_operating_system_update
#              secondary_info: last-changed
#              name: Обновления HAOs
              
        - type: markdown
          content: |
             <ha-icon icon="mdi:home-assistant"></ha-icon>&nbsp;&nbsp;&nbsp;Обновлений для Supervisor - {{ states('sensor.supervisor_updates') | default }}
             > {% for addon in state_attr('sensor.supervisor_updates', 'addons') %}
             > {{ addon.name }} {{ addon.version }} -> {{ addon.version_latest }}
             > {% endfor %}
             
        - type: markdown
          content: |
             <ha-icon icon="hacs:hacs"></ha-icon>&nbsp;&nbsp;&nbsp;Обновлений для HACS - {{ states('sensor.hacs') | default }}
             > {% for repo in state_attr('sensor.hacs', 'repositories') %}
             > {{ repo.display_name }} {{ repo["installed_version"] }} -> {{ repo["available_version"] }}
             > {% endfor %}